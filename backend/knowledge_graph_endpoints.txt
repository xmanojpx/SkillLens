# Add these new endpoints to simple_app.py after the existing endpoints

class LearningPathRequest(BaseModel):
    current_skills: List[str]
    target_role: str

class SkillDependencyRequest(BaseModel):
    skill: str

@app.post("/api/skills/learning-path")
async def get_learning_path(request: LearningPathRequest):
    """
    Generate optimal learning path using graph algorithms
    Uses modified Dijkstra's algorithm considering dependencies
    """
    if not skill_graph:
        raise HTTPException(status_code=500, detail="Knowledge graph not loaded")
    
    result = skill_graph.find_optimal_learning_path(
        request.current_skills,
        request.target_role
    )
    
    if "error" in result:
        raise HTTPException(status_code=404, detail=result["error"])
    
    return result

@app.post("/api/skills/dependencies")
async def get_skill_dependencies(request: SkillDependencyRequest):
    """Get all dependencies for a specific skill"""
    if not skill_graph:
        raise HTTPException(status_code=500, detail="Knowledge graph not loaded")
    
    result = skill_graph.get_skill_dependencies(request.skill)
    
    if "error" in result:
        raise HTTPException(status_code=404, detail=result["error"])
    
    return result

@app.post("/api/skills/gap-analysis-advanced")
async def analyze_gap_advanced(request: SkillGapRequest):
    """
    Advanced skill gap analysis using knowledge graph
    Provides categorized skills and readiness level
    """
    if not skill_graph:
        raise HTTPException(status_code=500, detail="Knowledge graph not loaded")
    
    result = skill_graph.analyze_skill_gap(
        request.user_skills,
        request.target_role
    )
    
    if "error" in result:
        raise HTTPException(status_code=404, detail=result["error"])
    
    return result

@app.get("/api/skills/roles")
async def get_available_roles():
    """Get all available roles in the knowledge graph"""
    if not skill_graph:
        raise HTTPException(status_code=500, detail="Knowledge graph not loaded")
    
    return {
        "roles": list(skill_graph.roles.keys()),
        "total_skills": len(skill_graph.skills)
    }
